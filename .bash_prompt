export PROMPT_COMMAND='hpwd=$(history 1); hpwd="${hpwd# *[0-9]*  }"; if [[ ${hpwd%% *} == "cd" ]]; then cwd=$OLDPWD; else cwd=$PWD; fi; echo "cd $cwd && $hpwd" >> ~/.bash_directory_history;if [[ `uname` != "Linux" ]];then update_terminal_cwd; fi' #output into .bash_directory_history after every command the history entrry plus the directory in which the command was run. often context matters. also, if not on linux, run 'update_terminal_cwd', which allows mac to open new terminal windows in the same directory as the one from which you openeed it.
